<!DOCTYPE html>
<html>
<head>
    <title>Student Overview by Block</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        function changeBlock() {
            let block = document.getElementById("block-select").value;
            window.location.href = "/admin/students?block=" + block;
        }
    </script>
</head>
<body class="p-4">
    <h2>ğŸ‘©ğŸ« Admin - Students by Block</h2>

    <div class="mb-3">
        <label for="block-select">Filter by Block:</label>
        <select id="block-select" onchange="changeBlock()" class="form-select" style="width: 200px;">
            {% for block in blocks %}
            <option value="{{ block }}" {% if block == selected_block %}selected{% endif %}>Block {{ block }}</option>
            {% endfor %}
        </select>
    </div>

    <table class="table table-bordered table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>QR ID</th>
                <th>Passes Left</th>
                <th>Checking Balance</th>
                <th>Last Tap In</th>
                <th>Last Tap Out</th>
            </tr>
        </thead>
        <tbody>
            {% for student in students %}
            <tr>
                <td>
                    <a href="{{ url_for('student_detail', student_id=student.id) }}">
                        {{ student.name }}
                    </a>
                </td>
                <td>{{ student.email }}</td>
                <td>{{ student.qr_id }}</td>
                <td>{{ student.passes_left }}</td>
                <td>${{ "%.2f"|format(student.checking_balance) }}</td>
                <td>{{ student.last_tap_in.strftime('%Y-%m-%d %H:%M') if student.last_tap_in else 'â€”' }}</td>
                <td>{{ student.last_tap_out.strftime('%Y-%m-%d %H:%M') if student.last_tap_out else 'â€”' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <a class="btn btn-outline-secondary mt-4" href="/admin">â† Back to Overview</a>
</body>
</html>
